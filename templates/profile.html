{% extends "base.html" %}

{% block content %}
<h2>Welcome, {{ current_user.username }}!</h2>
<p>Email: {{ current_user.email }}</p>
<p>User Type: {{ current_user.user_type }}</p>

<h3>Subscription Information</h3>
<p>Current Tier: {{ current_user.subscription_tier }}</p>
<p>Monthly Recurring Revenue: ${{ "%.2f"|format(current_user.mrr) }}</p>
{% if current_user.subscription_end_date %}
    <p>Subscription End Date: {{ current_user.subscription_end_date.strftime('%Y-%m-%d') }}</p>
{% endif %}

<h3>Change Subscription</h3>
<form action="{{ url_for('change_subscription') }}" method="POST">
    <select name="new_tier">
        <option value="free" {% if current_user.subscription_tier == 'free' %}selected{% endif %}>Free</option>
        <option value="pro" {% if current_user.subscription_tier == 'pro' %}selected{% endif %}>Pro</option>
        <option value="premium" {% if current_user.subscription_tier == 'premium' %}selected{% endif %}>Premium</option>
    </select>
    <button type="submit">Change Subscription</button>
</form>

{% if current_user.subscription_tier != 'free' %}
    <form action="{{ url_for('cancel_subscription') }}" method="POST">
        <button type="submit" onclick="return confirm('Are you sure you want to cancel your subscription?')">Cancel Subscription</button>
    </form>
{% endif %}

<!-- ... (rest of the profile content remains unchanged) -->
{% endblock %}
