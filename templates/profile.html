{% extends "base.html" %}

{% block content %}
<h2>Welcome, {{ current_user.username }}!</h2>
<p>Email: {{ current_user.email }}</p>
<p>User Type: {{ current_user.user_type }}</p>

<h3>Onboarding Progress</h3>
<div class="progress-bar">
    <div class="progress" style="width: {{ current_user.onboarding_progress }}%;">{{ current_user.onboarding_progress }}%</div>
</div>
{% if current_user.onboarding_progress < 100 %}
<a href="{{ url_for('onboard', user_type=current_user.user_type) }}" class="btn btn-primary">Continue Onboarding</a>
{% endif %}

<h3>Gardening Profile</h3>
<ul>
    <li>Experience: {{ current_user.experience or 'Not specified' }}</li>
    <li>Interests: {{ current_user.interests or 'Not specified' }}</li>
    <li>Location: {{ current_user.location or 'Not specified' }}</li>
    <li>Garden Size: {{ current_user.garden_size or 'Not specified' }}</li>
    <li>Soil Type: {{ current_user.soil_type or 'Not specified' }}</li>
    <li>Sunlight Exposure: {{ current_user.sunlight or 'Not specified' }}</li>
    <li>Watering Frequency: {{ current_user.watering_frequency or 'Not specified' }}</li>
    <li>Preferred Products: {{ current_user.preferred_products or 'Not specified' }}</li>
    <li>Organic Preference: {{ 'Yes' if current_user.organic_preference else 'No' }}</li>
    <li>Climate Zone: {{ current_user.climate_zone or 'Not specified' }}</li>
</ul>

<h4>Gardening Goals</h4>
<p>{{ current_user.goals or 'Not specified' }}</p>

<h4>Gardening Challenges</h4>
<p>{{ current_user.challenges or 'Not specified' }}</p>

<h3>Subscription Information</h3>
<p>Current Tier: {{ current_user.subscription_tier }}</p>
{% if current_user.subscription_end_date %}
    <p>Subscription End Date: {{ current_user.subscription_end_date.strftime('%Y-%m-%d') }}</p>
{% endif %}

{% if current_user.subscription_tier != 'free' %}
    <form action="{{ url_for('cancel_subscription') }}" method="POST">
        <input type="hidden" name="csrf_token" value="{{ csrf_token() }}" />
        <button type="submit" class="btn btn-danger" onclick="return confirm('Are you sure you want to cancel your subscription?')">Cancel Subscription</button>
    </form>
{% else %}
    <a href="{{ url_for('subscriptions') }}" class="btn btn-primary">Upgrade Subscription</a>
{% endif %}

{% if current_user.user_type == 'seller' %}
    <h3>Your Products</h3>
    <ul>
        {% for product in current_user.products %}
            <li>
                <a href="{{ url_for('product_detail', product_id=product.id) }}">{{ product.name }}</a>
                - ${{ product.price }}
            </li>
        {% endfor %}
    </ul>
    <a href="{{ url_for('create_product') }}" class="btn btn-secondary">Add New Product</a>
{% endif %}

{% if current_user.user_type == 'vendor' %}
    <h3>Your Services</h3>
    <ul>
        {% for service in current_user.services %}
            <li>
                {{ service.name }} - ${{ service.price }}
            </li>
        {% endfor %}
    </ul>
    <a href="{{ url_for('create_service') }}" class="btn btn-secondary">Add New Service</a>
{% endif %}
{% endblock %}
